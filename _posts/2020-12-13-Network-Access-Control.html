---
title: Network Access Control
date: 2020-12-13
layout: post
medium: https://ritikk.medium.com/network-access-control-6e3b27b00830
---
<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Network Access Control</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Network Access Control</h1>
</header>
<section data-field="subtitle" class="p-summary">
You must have heard that open and coffee shop wifis are insecure, and one must proceed with cautions. Now think about large corporates or
</section>
<section data-field="body" class="e-content">
<section name="884c" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d68b" id="d68b" class="graf graf--h3 graf--leading graf--title">Network Access Control</h3><h4 name="7ea1" id="7ea1" class="graf graf--h4 graf-after--h3 graf--subtitle">This work is a part of my presentation for the course CSN-502 Advanced Operating System. The presentation was delivered on 31.10.2020, and the topic for the same was Network Access Control — EAP framework. To my interest, I added focus to Wireless protocols as well. Most of the content can be found easily by Google search; hence if interested, I would recommend following the sources added in the references section. Take this one only as an introduction to the topic. The ppt is attached below.</h4><div name="79ec" id="79ec" class="graf graf--mixtapeEmbed graf-after--h4"><a href="https://1drv.ms/p/s!AnYk3B0CuVyGlg23VpXu-qX6eWtG?e=BtjrAL" data-href="https://1drv.ms/p/s!AnYk3B0CuVyGlg23VpXu-qX6eWtG?e=BtjrAL" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://1drv.ms/p/s!AnYk3B0CuVyGlg23VpXu-qX6eWtG?e=BtjrAL"><strong class="markup--strong markup--mixtapeEmbed-strong">Network Access Control</strong></a><a href="https://1drv.ms/p/s!AnYk3B0CuVyGlg23VpXu-qX6eWtG?e=BtjrAL" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="9e826c3bb86569472cdc6d420423c93c" data-thumbnail-img-id="0*-wGCAHne6CR1kCLY" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*-wGCAHne6CR1kCLY);"></a></div><p name="2714" id="2714" class="graf graf--p graf-after--mixtapeEmbed">You must have heard that open and coffee shop wifis are insecure, and one must proceed with cautions. Now think about large corporates or campus networks. There’s a ton of stuff involved here which are private within the network and must be protected via access control and prevented from eavesdropping. Remember, a network is not just used for connecting to the internet. A single malicious device or some malicious programs in some innocent device can bring massive troubles to the network providers. All other stuff related to secure access management applies here as well.</p><p name="8a9f" id="8a9f" class="graf graf--p graf-after--p">So broadly, it is the job of the Network Access Control System to proactively detect and authorize the devices and put certain access control in place. It should also provide a mechanism to deal with malicious programs and actors acting with bad faith from within or outside the network.</p><!--break--><p name="ef83" id="ef83" class="graf graf--p graf-after--p">Broadly any general NAC system should have at least these <strong class="markup--strong markup--p-strong">functionalities</strong>:</p><figure name="1299" id="1299" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pzUn_9OvCGXoyjvgrR4pmg.png" data-width="846" data-height="385" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*pzUn_9OvCGXoyjvgrR4pmg.png"></figure><ul class="postList"><li name="e984" id="e984" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">Node Detection</strong>:<strong class="markup--strong markup--li-strong"> </strong>This indeed is the first step to find out if there’s a new device connected to the network. The system can detect the traffic from protocols like ARP, which are essential when registering in a network or from explicit NAC register messages.</li><li name="602f" id="602f" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Authentication</strong>: Authenticating the device or the user trying to access the network.</li><li name="dda0" id="dda0" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Assessment</strong>: A secure network must assess a device before giving it access to the system’s resources for potential threats.</li><li name="7eca" id="7eca" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Authorization</strong>: NAC must use some policy to provide the user with access to the network’s resources based on the user’s/device’s identification and assessment.</li><li name="5ad8" id="5ad8" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Quarantine</strong>: NAC can isolate non-compliant devices into a separate network where it doesn’t possess a threat to the network and can still access specific safe resources.</li><li name="5b26" id="5b26" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Remediation</strong>: Quarantined devices should be allowed to join or get access to system resources upon undergoing remedies like downloading security patches or firewall setup.</li><li name="7d9a" id="7d9a" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Monitor:</strong> The devices admitted to the network should be continuously monitored for some policy violation upon which it can be Quarantined, or the access can be dropped and actions can be taken.</li></ul><p name="2875" id="2875" class="graf graf--p graf-after--li">An NAC system generally has these components:</p><ul class="postList"><li name="d187" id="d187" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Client</strong>: These are the devices trying to access the network. These are of 2 types: <strong class="markup--strong markup--li-strong">Agent-based Client</strong>, where an agent (a software) is already installed on the client. This client then communicates with the policy servers to make the client compliant with network security parameters like installing anti-virus software. <strong class="markup--strong markup--li-strong">Agent-less Clients</strong> are made to install an agent for joining the network. If it cannot, its traffic is monitored for threat management.</li><li name="4a79" id="4a79" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Enforcement Points</strong>: These are points in the network where action can be taken for a device. These are generally the points with which the client communicates to access the network. Example: Switches, Routers, VPN.</li><li name="de3c" id="de3c" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Policy Servers</strong>: As the name suggests, these servers are responsible for policy enforcements like Access, Authorization, and Accounting. These servers are responsible for collecting assessment data and ensuring compliance.</li><li name="e813" id="e813" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Quarantine Network</strong>: This is a network (as defined earlier) for the non-compliant devices. They are allowed limited or no access to network resources and remediation servers.</li><li name="f697" id="f697" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Remediation Servers</strong>: These servers are responsible for checking Quarantined devices for their compliances with network standards. These can provide with required security software to those devices for the purpose.</li></ul><h3 name="44ff" id="44ff" class="graf graf--h3 graf-after--li">Extensible Authentication Protocol</h3><p name="0554" id="0554" class="graf graf--p graf-after--h3">EAP (RFC <a href="https://tools.ietf.org/html/rfc3748" data-href="https://tools.ietf.org/html/rfc3748" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">3748</a>, <a href="https://tools.ietf.org/html/rfc5247" data-href="https://tools.ietf.org/html/rfc5247" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">5247</a>) is an authentication framework, not a specific authentication mechanism, used in network and internet connection for providing the transport and negotiation of authentication methods via<strong class="markup--strong markup--p-strong"> EAP methods</strong>. EAP typically runs directly over data link layers without requiring IP. EAP is not a wire protocol; instead, it only defines the information from the interface and the formats. Each protocol that uses EAP defines a way to encapsulate by the user EAP messages within that protocol’s messages. It has been applied to a wide variety of networks and protocols like wired networks [<a href="https://tools.ietf.org/html/rfc5247#ref-IEEE-802.1X" data-href="https://tools.ietf.org/html/rfc5247#ref-IEEE-802.1X" class="markup--anchor markup--p-anchor" title="&quot;Local and Metropolitan Area Networks: Port-Based Network Access Control&quot;" rel="noopener" target="_blank">IEEE-802.1X</a>], Internet Key Exchange Protocol version<br> 2 (IKEv2) [<a href="https://tools.ietf.org/html/rfc4306" data-href="https://tools.ietf.org/html/rfc4306" class="markup--anchor markup--p-anchor" title="&quot;Internet Key Exchange (IKEv2) Protocol&quot;" rel="noopener" target="_blank">RFC4306</a>], and wireless networks such as [<a href="https://tools.ietf.org/html/rfc5247#ref-IEEE-802.11" data-href="https://tools.ietf.org/html/rfc5247#ref-IEEE-802.11" class="markup--anchor markup--p-anchor" title="&quot;Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific Requirements Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications&quot;" rel="noopener" target="_blank">IEEE-802.11</a>] and<br> [<a href="https://tools.ietf.org/html/rfc5247#ref-IEEE-802.16e" data-href="https://tools.ietf.org/html/rfc5247#ref-IEEE-802.16e" class="markup--anchor markup--p-anchor" title="&quot;IEEE Standard for Local and Metropolitan Area Networks: Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems: Amendment for Physical and Medium Access Control Layers for Combined Fixed and Mobile Operations in Licensed Bands&quot;" rel="noopener" target="_blank">IEEE-802.16e</a>].</p><p name="b723" id="b723" class="graf graf--p graf-after--p">EAP defines 4 (generally 3) entities for authenticating a device. Some of these entities can be and are usually handled by the same device in a setup. These are:</p><ul class="postList"><li name="b382" id="b382" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Supplicant</strong>: This refers to the device seeking admission into the network.</li><li name="10d4" id="10d4" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Authenticator</strong>: The entity which relays and initiates EAP authentication. It may not know specifics of the actual wire protocol used.</li><li name="4faf" id="4faf" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Authentication Server</strong>: This is the place where the actual authentication takes place.</li><li name="cfcb" id="cfcb" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">EAP server</strong>: Its job is to exchange EAP messages with the supplicant via authenticator. The authentication server then uses these messages. It is often handled by other entities.</li></ul><h4 name="bb10" id="bb10" class="graf graf--h4 graf-after--li">EAP Authentication Process</h4><figure name="d6d2" id="d6d2" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*743swMTQM7eY9fQIR8qAPA.png" data-width="1600" data-height="1158" src="https://cdn-images-1.medium.com/max/800/1*743swMTQM7eY9fQIR8qAPA.png"><figcaption class="imageCaption">This image describes EAP over LAN (802.1X)</figcaption></figure><ol class="postList"><li name="ed1d" id="ed1d" class="graf graf--li graf-after--figure">The <strong class="markup--strong markup--li-strong">authenticator </strong>sends a Request to authenticate the peer (code 1). The Request has a <strong class="markup--strong markup--li-strong">Type field</strong> to indicate what is being requested.​</li><li name="c907" id="c907" class="graf graf--li graf-after--li">The peer sends a Response packet (code 2) in reply to a valid Request. As with the Request packet, the Response packet contains a Type field, which corresponds to the Type field of the Request.​</li><li name="9720" id="9720" class="graf graf--li graf-after--li">The authenticator sends an additional Request packet, and the peer replies with a Response. The sequence of Requests and Responses continues as long as needed. ​</li><li name="3194" id="3194" class="graf graf--li graf-after--li">The conversation continues until the authenticator cannot authenticate the peer in which case the authenticator implementation MUST transmit an <strong class="markup--strong markup--li-strong">EAP Failure</strong> (Code 4). Alternatively, the authentication conversation can continue until the authenticator determines that successful authentication has occurred, in which case the authenticator MUST transmit an <strong class="markup--strong markup--li-strong">EAP Success</strong> (Code 3).​</li></ol><h4 name="cf33" id="cf33" class="graf graf--h4 graf-after--li">Security Claims</h4><p name="3cbd" id="3cbd" class="graf graf--p graf-after--h4">EAP is used in wireless and wired LANs. In these situations, an attacker can gain access to links over which EAP packets are transmitted. As an example, one can easily detect all the traffic going in a wireless network without even authenticating into the network. As such, there are several security concerns which EAP defines and the EAP methods should take care of. These can be found <a href="https://tools.ietf.org/html/rfc3748#section-7.2.1" data-href="https://tools.ietf.org/html/rfc3748#section-7.2.1" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><h4 name="fa24" id="fa24" class="graf graf--h4 graf-after--p">EAP Methods Example</h4><ul class="postList"><li name="6328" id="6328" class="graf graf--li graf-after--h4"><strong class="markup--strong markup--li-strong">EAP-MD5</strong>: Here, the server sends a random challenge to the client. The client forms an MD5 hash of the user’s password and the challenge and sends the result back to the server. The server then validates the MD5 hash using the known correct plaintext password from the user database. Hence, It offers minimal security, is vulnerable to dictionary attacks, it only provides authentication of the EAP peer to the EAP server but not mutual authentication, hence is vulnerable to MITM.</li><li name="bbca" id="bbca" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">EAP-TLS​</strong>: Transport Layer Security (TLS) provides for mutual authentication, integrity-protected cipher suite negotiation, and key exchange between two endpoints. EAP-TLS is still considered one of the most secure EAP standards available. This has also been used in NoAuth cases where only server authentication is done. This would allow for situations, much like HTTPS, where a wireless hotspot allows free access and does not authenticate clients. Still, clients wish to use encryption and potentially authenticate the wireless hotspot. With a client-side certificate, however, a compromised password is not enough to break into EAP-TLS enabled systems because the intruder still needs to have the client-side certificate.</li><li name="646f" id="646f" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">EAP-PSK</strong>​: EAP method for mutual authentication and session key derivation using a <strong class="markup--strong markup--li-strong">Pre-Shared Key</strong> (PSK). The Pre-Shared Key refers to a key or secret that needs to be derived and shared by the parties by some mechanism before the EAP-PSK conversation takes place (Take this as a simple passphrase). EAP-PSK is designed for authentication over insecure networks such as <strong class="markup--strong markup--li-strong">IEEE 802.11</strong>(standards for Wireless LAN (WLAN) &amp; Mesh (Wi-Fi certification)). EAP-PSK is distinct from the Pre-shared Key authentication mode used in<strong class="markup--strong markup--li-strong"> Wi-Fi Protected Access</strong>(WPA) and should not be confused with it.</li></ul><h3 name="2390" id="2390" class="graf graf--h3 graf-after--li">Implementations</h3><h4 name="cf6d" id="cf6d" class="graf graf--h4 graf-after--h3"><strong class="markup--strong markup--h4-strong">Wi-Fi (Wireless Fidelity) History</strong></h4><p name="2c53" id="2c53" class="graf graf--p graf-after--h4"><strong class="markup--strong markup--p-strong">Wired Equivalent Privacy</strong> (WEP) is a security algorithm for IEEE 802.11 wireless networks. Introduced as part of the original 802.11 standard ratified in 1997, its intention was to provide data <strong class="markup--strong markup--p-strong">confidentiality comparable</strong> to that of a traditional <strong class="markup--strong markup--p-strong">wired</strong> network.</p><p name="5a45" id="5a45" class="graf graf--p graf-after--p">Later, to address WEP security issues, the <strong class="markup--strong markup--p-strong">802.11 working group</strong> adopted the <strong class="markup--strong markup--p-strong">802.1X</strong> standard for <strong class="markup--strong markup--p-strong">authentication</strong>, <strong class="markup--strong markup--p-strong">authorization </strong>and <strong class="markup--strong markup--p-strong">key management</strong>. <strong class="markup--strong markup--p-strong">IEEE 802.1X</strong> is an IEEE Standard for port-based Network Access Control (PNAC). It provides an authentication mechanism to devices wishing to attach to a LAN or WLAN. At the same time, IEEE formed a Task Group “I” to develop <strong class="markup--strong markup--p-strong">802.11i</strong> standard, with a purpose to produce a detailed specification to enhance the security features for wireless LANs dramatically.</p><p name="3662" id="3662" class="graf graf--p graf-after--p">In 2003 the <strong class="markup--strong markup--p-strong">Wi-Fi Alliance</strong> announced that WEP had been superseded by <strong class="markup--strong markup--p-strong">Wi-Fi Protected Access </strong>(WPA). They extracted the key features from 802.11i to establish WPA to satisfy the immediate needs of the wireless industry. WPA became available in 2003 based on a subset of a <strong class="markup--strong markup--p-strong">draft </strong>of <strong class="markup--strong markup--p-strong">802.11i</strong>. IEEE 802.11i describes EAP for wireless LANs.</p><p name="eeed" id="eeed" class="graf graf--p graf-after--p">However, WPA has shown significant vulnerabilities and was later superseded by <strong class="markup--strong markup--p-strong">WPA2</strong>,, which is based on IEEE 802.11i standard ratified in June 2004.</p><p name="178e" id="178e" class="graf graf--p graf-after--p">In January 2018, Wi-Fi Alliance announced the release of <strong class="markup--strong markup--p-strong">WPA3 </strong>with several security improvements over WPA2.</p><h4 name="c287" id="c287" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">WEP</strong></h4><p name="3556" id="3556" class="graf graf--p graf-after--h4">WEP was ratified as a Wi-Fi security standard in September of 1999. WEP uses the <a href="https://en.wikipedia.org/wiki/Stream_cipher" data-href="https://en.wikipedia.org/wiki/Stream_cipher" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">stream cipher</a> <a href="https://en.wikipedia.org/wiki/RC4" data-href="https://en.wikipedia.org/wiki/RC4" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">RC4</a> for <strong class="markup--strong markup--p-strong">confidentiality </strong>and the <a href="https://en.wikipedia.org/wiki/CRC-32" data-href="https://en.wikipedia.org/wiki/CRC-32" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CRC-32</a> checksum for <strong class="markup--strong markup--p-strong">integrity</strong>. WEP generally uses Pre-Shared Key (PSK); however, it uses rudimentary variations of the same key to encrypt all packets . These weak encryption keys are based on the underlying RC4 crypto algorithm. This is not very safe, a large sample of encrypted packets using the same key tends to create an easy key recovery target for hackers. Furthermore, to change a WEP key requires an IT administrator to update each client machine manually. As a result, changing pre-shared keys regularly to safeguard against key recovery is a highly unfeasible task to scale for large deployments.</p><p name="cd79" id="cd79" class="graf graf--p graf-after--p">Systems that rely on WEP should be upgraded or, if security upgrades are not an option, replaced.</p><h4 name="8509" id="8509" class="graf graf--h4 graf-after--p">WPA</h4><p name="1e3a" id="1e3a" class="graf graf--p graf-after--h4">As discussed above, WiFi Protected Access was formally adopted in 2003, a year before WEP was officially retired.</p><p name="3eb4" id="3eb4" class="graf graf--p graf-after--p">WPA keys use 256-bit keys. Its most common configuration is called the <strong class="markup--strong markup--p-strong">WPA-PSK</strong> or <strong class="markup--strong markup--p-strong">WiFi Protected Access Pre-Shared Key</strong>. WPA included <strong class="markup--strong markup--p-strong">message integrity checks</strong> (to determine if an attacker had captured or altered packets passed between the access point and client) and the <strong class="markup--strong markup--p-strong">Temporal Key Integrity Protocol </strong>(TKIP). TKIP employs a per-packet key system that was radically more secure than the fixed key system used by WEP. Although TKIP uses the same base encryption algorithm, RC4 as WEP, the way it selects and changes keys resolves many of the issues surrounding WEP.</p><p name="1df1" id="1df1" class="graf graf--p graf-after--p">The primary improvement in WPA is the per-session encryption key. Every time a station associates, a new encryption key is generated based on some per-session random numbers and the media access control (MAC) addresses of the station and the access point. WPA sounds like a major improvement, and it is — if it’s used correctly.</p><p name="d0d1" id="d0d1" class="graf graf--p graf-after--p">WPA with pre-shared keys can be cracked if IT management unwisely uses straightforward passwords. However, this is not a weakness in WPA security, but rather a potential result of poor password management. An attacker grabs a few packets at the time a legitimate station joins the wireless network and then can take those packets and recover the PSK used.</p><p name="9297" id="9297" class="graf graf--p graf-after--p">WPA used with 802.1X authentication (<strong class="markup--strong markup--p-strong">WPA-Enterprise</strong>) offers a secure, per-session encryption key that is not vulnerable to any casual attack. This security comes with a cost because 802.1X authentication requires a significant infrastructure including 802.1X-compliant <strong class="markup--strong markup--p-strong">RADIUS</strong> server with a digital certificate, and client software for every user that supports 802.1X and whichever authentication mode they use.</p><h4 name="7c5e" id="7c5e" class="graf graf--h4 graf-after--p">WPA2</h4><p name="c90e" id="c90e" class="graf graf--p graf-after--h4">WiFi Protected Access II, as discussed above, was ratified in 2004, and replaced WPA. WPA2 implements the mandatory elements of IEEE 802.11i. In particular, it includes mandatory support for <a href="https://en.wikipedia.org/wiki/CCMP_%28cryptography%29" data-href="https://en.wikipedia.org/wiki/CCMP_(cryptography)" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CCMP</a>(<strong class="markup--strong markup--p-strong">Counter Cipher Mode with Block Chaining Message Authentication Code Protocol</strong>), an <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" data-href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">AES</strong></a><strong class="markup--strong markup--p-strong"> </strong>based encryption mode as a replacement for TKIP.</p><p name="2b78" id="2b78" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Working</strong></p><figure name="a539" id="a539" class="graf graf--figure graf--layoutOutsetLeft graf-after--p"><img class="graf-image" data-image-id="1*C1hd3PqmkFO-YdgoJGdrnw.png" data-width="1024" data-height="733" src="https://cdn-images-1.medium.com/max/600/1*C1hd3PqmkFO-YdgoJGdrnw.png"><figcaption class="imageCaption">four-way handshake</figcaption></figure><p name="4ed9" id="4ed9" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">four-way handshake</strong> is the process of exchanging 4 messages between an Access Point (AP) (<strong class="markup--strong markup--p-strong">authenticator</strong>) and the client device (<strong class="markup--strong markup--p-strong">supplicant</strong>) to generate some encryption keys which can be used to encrypt actual data sent over Wireless medium.</p><p name="7a47" id="7a47" class="graf graf--p graf-after--p">While Enterprise version use 802.1x exchanges (as discussed above) before handshake, personal directly begins handshake using <strong class="markup--strong markup--p-strong">Pairwise Master key </strong>(PMK) (generated from PSK).</p><p name="c91a" id="c91a" class="graf graf--p graf-after--p">The <strong class="markup--strong markup--p-strong">Master Session Key</strong> (MSK) is the first key which is generated either from 802.1X/EAP (Enterprise) or derived from PSK authentication (Personal). Pairwise master is key generated from this master session key. In case of WPA2/PSK when device authenticates with access point the PMK is simply derived from PSK.</p><p name="2122" id="2122" class="graf graf--p graf-after--p">Here, with the four way handshake, the client is able to generate a <strong class="markup--strong markup--p-strong">Pairwise Transit Key </strong>(PTK) and <strong class="markup--strong markup--p-strong">Group Temporal Key</strong> (GTK). All unicast traffic will be encrypted with PTK and all multicast and broadcast traffic will be encrypted via GTK.</p><pre name="1828" id="1828" class="graf graf--pre graf-after--p">PTK = PRF (PMK + Anonce + SNonce + Mac (AA)+ Mac (SA))</pre><p name="42b2" id="42b2" class="graf graf--p graf-after--pre">For PTK, <strong class="markup--strong markup--p-strong">PRF</strong> is a pseudo-random function, <strong class="markup--strong markup--p-strong">Anonce</strong> is supplied by the AP in the 1st message. <strong class="markup--strong markup--p-strong">SNonce</strong> is generated by the client. Mac address of the AP and supplicant is known already. Hence PTK can be generated. GTK is generated by the AP and shared with the client in the 3rd message of the handshake.</p><p name="2598" id="2598" class="graf graf--p graf-after--p">For detailed explaination, follow this <a href="https://www.wifi-professionals.com/2019/01/4-way-handshake" data-href="https://www.wifi-professionals.com/2019/01/4-way-handshake" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">post</a>.</p><p name="c443" id="c443" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Issues</strong></p><p name="47ed" id="47ed" class="graf graf--p graf-after--p">The ability to crack the WPA2-Personal passphrase with brute-force attacks: basically guessing the password over and over until a match is found, is a critical vulnerability of WPA2. Making the problem worse, once hackers captured the right data from the airwaves, they could perform these password-guessing attempts off-site, making it more practical for them. Four-way handshake is susceptible to <strong class="markup--strong markup--p-strong">offline </strong>dictionary-based attacks, especially when short passwords under 16 characters are employed. Once cracked, they could then decrypt any data they captured before or after the cracking.</p><p name="300f" id="300f" class="graf graf--p graf-after--p">Another major vulnerability of WPA2-Personal, particularly on business networks, is that a user with the passphrase could snoop on another user’s network traffic and perform attacks. This is more evident in open networks. Although the enterprise mode of WPA/WPA2 protects against user-to-user snooping, it requires a RADIUS server or cloud service to deploy the enterprise mode.</p><p name="3e77" id="3e77" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">KRACK attack</strong></p><p name="60f8" id="60f8" class="graf graf--p graf-after--p">The<strong class="markup--strong markup--p-strong"> </strong><a href="https://www.krackattacks.com/?_ga=2.182670950.1957743772.1508163997-2044333671.1507156536" data-href="https://www.krackattacks.com/?_ga=2.182670950.1957743772.1508163997-2044333671.1507156536" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">Key Reinstallation Attack</strong></a> (KRACK) is a direct attack on the WPA2 protocol and not in individual products or implementations.</p><p name="eefe" id="eefe" class="graf graf--p graf-after--p">Essentially, KRACK undermines the four-way handshake, allowing a hacker to intercept and manipulate the creation of new encryption keys within the secure connection process. The adversary tricks a victim into reinstalling an already-in-use key. When the victim reinstalls the key, associated parameters such as nonce and receive packet number (i.e. replay counter) are reset to their initial value.</p><p name="d82a" id="d82a" class="graf graf--p graf-after--p">During the four way handshake, if the 3rd message is received again, the client will reinstall the same encryption key, and thereby reset the incremental transmit packet number (nonce) and receive replay counter used by the encryption protocol. By forcing nonce reuse in this manner, the encryption protocol can be attacked, e.g., packets can be replayed, decrypted, and/or forged. Adversaries can use this attack to decrypt packets sent by clients. As a result, <strong class="markup--strong markup--p-strong">the same encryption key is used with nonce values that have already been used in the past</strong>. In turn, this causes all encryption protocols of WPA2 to reuse <a href="https://en.wikipedia.org/wiki/Keystream" data-href="https://en.wikipedia.org/wiki/Keystream" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">keystream</a> when encrypting packets. In case a message that reuses keystream has known content, it becomes trivial to derive the used keystream. This keystream can then be used to decrypt messages with the same nonce. When there is no known content, it is harder to decrypt packets, although still possible in several cases. In practice, finding packets with known content is not a problem, so it should be assumed that any packet can be decrypted.</p><h4 name="9dc0" id="9dc0" class="graf graf--h4 graf-after--p">WPA 3</h4><p name="824f" id="824f" class="graf graf--p graf-after--h4">In 2018, the Wi-Fi Alliance announced the next iteration called WPA3 to replace the WPA2, adding several security enhancements and features while overcoming the security vulnerabilities of the WPA2. It takes security to the next level by making wireless networks future ready. It uses the more powerful and robust encryption by AES with the GCMP (<strong class="markup--strong markup--p-strong">Galois/Counter Mode Protocol</strong>) and replaces the PSK with the more reliable and secure handshake mechanism called <strong class="markup--strong markup--p-strong">Simultaneous Authentication of Equals</strong> (SAE). SAE, also known as the <strong class="markup--strong markup--p-strong">Dragonfly Key Exchange Protocol</strong>, is a more secure method of key exchange that addresses the KRACK vulnerability. Specifically, it is resistant to offline decryption attacks through the provision of “<strong class="markup--strong markup--p-strong">forward secrecy</strong>.” Forward secrecy stops an attacker decrypting a previously recorded internet connection, even if they know the WPA3 password.</p><p name="d90b" id="d90b" class="graf graf--p graf-after--p">Have a look at this <a href="https://medium.com/asecuritysite-when-bob-met-alice/hello-to-wpa-3-ae8b9c365b95" data-href="https://medium.com/asecuritysite-when-bob-met-alice/hello-to-wpa-3-ae8b9c365b95" class="markup--anchor markup--p-anchor" target="_blank">post</a> for details.</p><h3 name="2950" id="2950" class="graf graf--h3 graf-after--p">References</h3><ul class="postList"><li name="2a07" id="2a07" class="graf graf--li graf-after--h3"><a href="https://www.diva-portal.org/smash/get/diva2:23688/FULLTEXT01.pdf" data-href="https://www.diva-portal.org/smash/get/diva2:23688/FULLTEXT01.pdf" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.diva-portal.org/smash/get/diva2:23688/FULLTEXT01.pdf</a></li><li name="7646" id="7646" class="graf graf--li graf-after--li"><a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.615.3578&amp;rep=rep1&amp;type=pdf" data-href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.615.3578&amp;rep=rep1&amp;type=pdf" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.615.3578&amp;rep=rep1&amp;type=pdf</a></li><li name="d993" id="d993" class="graf graf--li graf-after--li"><a href="https://www.computerworld.com/article/2544215/don-t-use-wep-for-wi-fi-security--researchers-say.html" data-href="https://www.computerworld.com/article/2544215/don-t-use-wep-for-wi-fi-security--researchers-say.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.computerworld.com/article/2544215/don-t-use-wep-for-wi-fi-security--researchers-say.html</a></li><li name="836a" id="836a" class="graf graf--li graf-after--li"><a href="https://www.networkworld.com/article/2329740/how-can-wpa-be-more-secure-than-wep-.html" data-href="https://www.networkworld.com/article/2329740/how-can-wpa-be-more-secure-than-wep-.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.networkworld.com/article/2329740/how-can-wpa-be-more-secure-than-wep-.html</a></li><li name="9b61" id="9b61" class="graf graf--li graf-after--li"><a href="https://www.networkworld.com/article/2325729/wpa---an-accident-waiting-to-happen.html" data-href="https://www.networkworld.com/article/2325729/wpa---an-accident-waiting-to-happen.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.networkworld.com/article/2325729/wpa---an-accident-waiting-to-happen.html</a></li><li name="dfc6" id="dfc6" class="graf graf--li graf-after--li"><a href="https://www.howtogeek.com/167783/htg-explains-the-difference-between-wep-wpa-and-wpa2-wireless-encryption-and-why-it-matters/" data-href="https://www.howtogeek.com/167783/htg-explains-the-difference-between-wep-wpa-and-wpa2-wireless-encryption-and-why-it-matters/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.howtogeek.com/167783/htg-explains-the-difference-between-wep-wpa-and-wpa2-wireless-encryption-and-why-it-matters/</a></li><li name="9d74" id="9d74" class="graf graf--li graf-after--li"><a href="https://www.krackattacks.com/?_ga=2.182670950.1957743772.1508163997-2044333671.1507156536" data-href="https://www.krackattacks.com/?_ga=2.182670950.1957743772.1508163997-2044333671.1507156536" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.krackattacks.com/?_ga=2.182670950.1957743772.1508163997-2044333671.1507156536</a></li><li name="08cb" id="08cb" class="graf graf--li graf-after--li"><a href="http://www.differencebetween.net/technology/difference-between-wpa2-and-wpa3/" data-href="http://www.differencebetween.net/technology/difference-between-wpa2-and-wpa3/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">http://www.differencebetween.net/technology/difference-between-wpa2-and-wpa3/</a></li><li name="c111" id="c111" class="graf graf--li graf-after--li"><a href="https://www.makeuseof.com/tag/wep-wpa-wpa2-wpa3-explained/" data-href="https://www.makeuseof.com/tag/wep-wpa-wpa2-wpa3-explained/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.makeuseof.com/tag/wep-wpa-wpa2-wpa3-explained/</a></li><li name="b01c" id="b01c" class="graf graf--li graf-after--li graf--trailing"><a href="https://www.networkworld.com/article/3316567/what-is-wpa3-wi-fi-security-protocol-strengthens-connections.html" data-href="https://www.networkworld.com/article/3316567/what-is-wpa3-wi-fi-security-protocol-strengthens-connections.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.networkworld.com/article/3316567/what-is-wpa3-wi-fi-security-protocol-strengthens-connections.html</a></li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@ritikk" class="p-author h-card">Ritik kumar</a> on <a href="https://medium.com/p/6e3b27b00830"><time class="dt-published" datetime="2020-12-13T18:10:48.424Z">December 13, 2020</time></a>.</p><p><a href="https://medium.com/@ritikk/network-access-control-6e3b27b00830" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 20, 2020.</p></footer></article></body></html>
